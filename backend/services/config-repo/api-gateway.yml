# ===============================================================
# FILE: api-gateway.yml (Phiên bản cuối cùng, đã sửa lỗi)
# ===============================================================

server:
  port: 8080

eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/

spring:
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true

      routes:
        # --- Route cho User Service ---
        - id: user-service-route
          uri: lb://USER-SERVICE
          predicates:
            - Path=/api/users/**

        # --- Route cho Station Service ---
        - id: station-service-route
          uri: lb://STATION-SERVICE
          predicates:
            - Path=/api/stations/**, /api/chargers/**

        # ====================================================
        # [COMMAND]: BỔ SUNG KHỐI NÀY VÀO
        # --- Route cho Charging Service ---
        - id: charging-service-route
          uri: lb://CHARGING-SERVICE # Tên service trên Eureka
          predicates:
            - Path=/api/sessions/**
        - id: payment-service-route
          uri: lb://PAYMENT-SERVICE
          predicates:
            - Path=/api/payments/**, /api/wallets/**

    # [COMMAND]: Cấu hình cho Load Balancer của Gateway
    loadbalancer:
      # Tắt cache để Gateway luôn lấy dữ liệu mới nhất từ Eureka (chỉ dùng khi dev)
      cache:
        enabled: false